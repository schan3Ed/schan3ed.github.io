!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.imageCompression=e()}(this,function(){"use strict";function t(t){return new Promise(function(e,n){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){e(i.result)},i.onerror=n})}function e(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();return new Promise(function(i){for(var r=t.split(","),o=r[0].match(/:(.*?);/)[1],a=atob(r[1]),h=a.length,u=new Uint8Array(h);h--;)u[h]=a.charCodeAt(h);var c=void 0;try{c=new File([u],e,{type:o})}catch(t){(c=new Blob([u],{type:o})).name=e,c.lastModified=n}i(c)})}function n(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){e(i)},i.onerror=n,i.src=t})}function i(t,e){var n=document.createElement("canvas"),i=n.getContext("2d");return Number.isInteger(e)&&(t.width>e||t.height>e)?t.width>t.height?(n.width=e,n.height=t.height/t.width*e):(n.width=t.width/t.height*e,n.height=e):(n.width=t.width,n.height=t.height),i.drawImage(t,0,0,n.width,n.height),n}function r(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY,a=arguments[2];return new Promise(function(h,u){var c,d,f,s,l,g=void 0,m=void 0,v=void 0;return r instanceof Blob||r instanceof File?/^image/.test(r.type)?(g=5,c=1024*o*1024,t(r).then(function(t){try{return d=t,n(d).then(function(t){try{return f=t,s=i(f,a),m=.9,e(s.toDataURL(r.type,m),r.name,r.lastModified).then(function(t){try{var n=function(){return h(v)};if(v=t,"image/png"===r.type){var i,o=function t(){if(g--&&v.size>c){var n=void 0;return s.width*=.9,s.height*=.9,(l=s.getContext("2d")).drawImage(f,0,0,s.width,s.height),n=s.toDataURL(r.type,m),e(n,r.name,r.lastModified).then(function(e){try{return v=e,t}catch(t){return u(t)}}.bind(this),u)}return[1]},a=function(){return n.call(this)};return(i=function(t){for(;t;){if(t.then)return void t.then(i,u);try{if(t.pop){if(t.length)return t.pop()?a.call(this):t;t=o}else t=t.call(this)}catch(t){return u(t)}}}.bind(this))(o)}var d,w=function t(){if(g--&&v.size>c){var n=void 0;return m*=.9,n=s.toDataURL(r.type,m),e(n,r.name,r.lastModified).then(function(e){try{return v=e,t}catch(t){return u(t)}}.bind(this),u)}return[1]},p=function(){return n.call(this)};return(d=function(t){for(;t;){if(t.then)return void t.then(d,u);try{if(t.pop){if(t.length)return t.pop()?p.call(this):t;t=w}else t=t.call(this)}catch(t){return u(t)}}}.bind(this))(w)}catch(t){return u(t)}}.bind(this),u)}catch(t){return u(t)}}.bind(this),u)}catch(t){return u(t)}}.bind(this),u)):u(new Error("The file given is not an image")):u(new Error("The file given is not an instance of Blob or File"))}.bind(this))}return r.drawImageInCanvas=i,r.getDataUrlFromFile=t,r.getFilefromDataUrl=e,r.loadImage=n,r});
//# sourceMappingURL=browser-image-compression.js.map
